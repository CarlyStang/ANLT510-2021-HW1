---
output: html_document
---

## Exercise 3.8

__This question involves the use of simple linear regression on the `Auto` data set.__

a. __Use the `lm()` function to perform a simple linear regression with mpg as the response and horsepower as the predictor. Use the `summary()` function to print the results. Comment on the output. For example:__

The code in the chunk below uses `lm()` to run the linear regression model

```{r}
library(ISLR)
data(Auto)

lm.fit <- lm(___ ~ ___, 
             data = Auto)
```

Next, we use `broom::tidy()` to reformat the output provided by `summary()` such that it can be used by `knitr::kable()` to create a table

```{r}
knitr::kable(broom::tidy(summary(lm.fit)))
```

i. __Is there a relationship between the predictor and the response?__

<!-- enter your solution here -->

ii. __How strong is the relationship between the predictor and the response?__

<!-- enter your solution here -->

iii. __Is the relationship between the predictor and the response positive or negative?__

<!-- enter your solution here -->
    
iv. __What is the predicted mpg associated with a horsepower of 98? What are the associated 95 % confidence and prediction intervals?__

To make a prediction we first need a new observation, this new observation is created in the chunk below as an object called `.new_data`

```{r}
.new_data = _______________
```

Next, we provide the new observation in `.new_data` to our model to see what target value is predicted.

```{r}
predict(lm.fit, 
        newdata = .new_data, 
        interval = "confidence",
        level = 0.95)

predict(lm.fit, 
        newdata = .new_data, 
        interval = "prediction",
        level = 0.95)
```

b. __Plot the response and the predictor. Use the `abline()` function to display the least squares regression line.__

The requested plot is generated by the following code.

```{r}
plot(x = ___________, 
     y = ___________,
     pch = 16,
     col = scales::alpha("black", alpha = 0.25))

abline(lm.fit, 
       lwd = 3, 
       col = 2)
```

c. __Use the `plot()` function to produce diagnostic plots of the least squares regression fit. Comment on any problems you see with the fit.__

If we simply plot an linear model created by `lm()` we are presented with a sequence of four plots.  In the chunk below we present these plots as a $2 \times 2$ grid

```{r}
par(mfrow = c(2,2))

plot(lm.fit)
```
